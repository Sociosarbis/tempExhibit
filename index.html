<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width:device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scale=no;">
    <script src="./static/js/hls.min.js"></script>
    <style>
    * {
        font-size: 14px;
    }
		.w-full {
			width: 100%;
		}
		.mb-2 {
			margin-bottom: 10px;
		}
		.mr-1 {
			margin-right: 5px; 
		}
    </style>
</head>
<body>
		<input class="w-full mb-2" id="url-input" placeholder="视频链接">
		<div class="mb-2">
			<input id="replace-video-button" class="mr-1" type="button" value="替换视频">
			<button><a href="//www.zuidazy3.net/index.php" target="resource-center">资源中心</a></button>
		</div>
		<video class="w-full" id="player" src="" controls="true" crossorigin="anonymous"></video>
    <script>
				const urlRegExp = /([a-zA-Z0-9]+:)?\/*?([^#\?\/:]+)(:\d+)?([^:#\?]*?)(\?[^#]*)?(#.*)?$/
        const replaceButton = document.getElementById('replace-video-button')
        const player = document.getElementById('player')
        const urlInput = document.getElementById('url-input')
        const hls = new Hls();
        hls.on(Hls.Events.MANIFEST_PARSED, function () {
            player.play();
        });
        replaceButton.addEventListener('click', function () {
						const match = urlInput.value.trim().match(urlInput.value)
						hls.detachMedia()
						if (match) {
							const url = match[0]
							if (/\.m3u8/.test(url)) {
                hls.attachMedia(player)
                hls.loadSource(url)
							} else {
									player.setAttribute('src', url)
									player.play()
							}
						}
        })
    </script>
</body>
</html>